*This File is Japanese  only

●診断プログラムについて

診断プログラムは、ご使用になられるボードが正常に動作するかをチェック
するアプリケーションです。

キーボード入力されたデータを送信したり、受信されたデータを画面に表示
することができます。
実際に診断するには通信する相手機器と通信ケーブルで接続する必要があり
ます。(*1)
相手機器の替わりに通信ボードの空いているチャネル(ポート)と接続してチ
ェックすることもできます。(*2)
その場合は診断プログラムを2つ起動してください。

CTSTCOM.EXEはCOM-DRVの診断プログラムです。
CTSTSIO.EXEはAPI-SIOの診断プログラムです。

*1)通信ボードと相手機器を接続する場合

┌──□パソコン□──┐
│┌───────┐  │                              ┌─□相手機器□─┐
││診断プログラム│  │┌─────┐  通信ケーブル  │                │
│└───────┘  ││通信ボード│────────│                │
│                    ││          │                └────────┘
│                    │└─────┘
│                    │
└──────────┘

*2)通信ボードと通信ボード[空きチャネル(ポート)]を接続する場合

┌──□パソコン□──┐
│┌───────┐  │
││診断プログラム│  │┌─────┐   通信ケーブル
│└───────┘  ││通信ボード│─────────┐
│┌───────┐  ││          │─────────┘
││診断プログラム│  │└─────┘
│└───────┘  │
└──────────┘


●診断プログラム起動方法

** Windows 2000以降で COM-DRV(W32)を使用時の注意 **

・Config.exeは使用しません。従って"C:\CONTEC\CTSTCOM.EXE"から起動し
てください。
・ボード選択のダイアログを表示しませんので、"診断プログラム操作方法"
で使用するCOMポートを選択してください。

>Config.exeから起動する場合
1.Config.exeの[ツール(T)]を選択し、使用したいドライバを選択してくだ
さい。
2.診断したいボード名を選択し、[診断(D)]-->[診断の実行]で起動します。

>エクスプローラから起動する場合
1."C:\CONTEC" から、CTSTCOM.EXEもしくはCTSTSIO.EXEを実行してください
。
2.[ダイアログでボード名を選択してください]のメッセージが表示しますの
で、[OK]ボタンをクリックしてください。次にConfig.exeに登録されている
ボードの一覧が表示されますので、診断したいボード名を選択し、[OK]ボタ
ンをクリックしてください。そのボードの先頭チャネル(ポート)が診断プロ
グラムのデフォルトとなります。
ボード名を選択せずに[OK]ボタンをクリックした場合、チャネル(ポート)は
不定となりますので、メニューの[設定(S)]-->[詳細設定]で選択してくださ
い。

>スタートメニューから起動する場合(API-SIO のみ)
1.スタートメニューから診断プログラムを実行してください。
2.[次のダイアログでボード名を選択してください]のメッセージが表示しま
すので、[OK]ボタンをクリックしてください。次にConfig.exeに登録されて
いるボードの一覧が表示されますので、診断したいボード名を選択し、[OK]
ボタンをクリックしてください。そのボードの先頭チャネル(ポート)が診断
プログラムのデフォルトとなります。
ボード名を選択せずに[OK]ボタンをクリックした場合、チャネル(ポート)は
不定となりますので、メニューの[設定(S)]-->[詳細設定]で選択してくださ
い。

●診断プログラム操作方法

1.[設定(S)]-->[詳細設定]で通信設定ダイアログが表示します。ここで、初
期設定、オプション、コントロールオプションを設定してください。ショー
トカットからの起動でボード名を選択せずに[OK]ボタンをクリックした場合
、チャネル(ポート)を設定してください。初期設定は通信相手の設定に合わ
せてください。

2.[OK]をクリックし[動作(A)]-->[接続]で相手機器との通信が可能な状態に
なります。

3.送信：キーボード入力されたデータが送信されます。
  受信：受信されたデータがテキストデータで自動的に表示します。ただし
バイナリデータは正常に表示できません。


●通信設定について
>初期設定
  チャネルorポート(P)：通信テストを行いたいチャネル(ポート)を設定し
てください。ただし、テストを行いたいチャネル(ポート)は、Config.exeに
て登録しておく必要があります。(Windows XP/2000でCOM-DRV(W32)を使用時
は必要なし)
  ボーレート(B)：通信したい相手機器との設定に合わせてください。設定
値が正常でない場合、通信エラーの原因となります。
  データビット(D)：通信したい相手機器との設定に合わせてください。設
定値が正常でない場合、通信エラーの原因となります。
  パリティ(A)：通信したい相手機器との設定に合わせてください。設定値
が正常でない場合、通信エラーの原因となります。
  ストップビット(S)：通信したい相手機器との設定に合わせてください。
設定値が正常でない場合、通信エラーの原因となります。

  フロー制御(L)：CtstComの場合
    ・DTR/DSR：受信バッファが4分の3以上まで埋まるとDTRラインをOFFに
し、半分以下まで空くとDTRラインをONにします。送信時にはDSRを監視しま
す。
    ・RTS/CTS：受信バッファが4分の3以上まで埋まるとRTSラインをOFFに
し、半分以下まで空くとRTSラインをONにします。送信時にはCTSを監視しま
す。
    ・XON/XOFF：送信時にXOFFを受信すると送信を停止し、XONを受信する
と送信を開始します。逆に、受信バッファが4分の3以上まで埋まるとXOFFコ
ードを送信し、4分の3未満まで空くとXONコードを送信します。

  フロー制御(L)：CtstSioの場合
    ・DTR/DSR：受信バッファが10分の9以上まで埋まるとDTRラインをOFFに
し、10分の1以下まで空くとDTRラインをONにします。送信時にはDSRを監視
します。
    ・RTS/CTS：受信バッファが10分の9以上まで埋まるとRTSラインをOFFに
し、10分の1以下まで空くとRTSラインをONにします。送信時にはCTSを監視
します。
    ・XON/XOFF：受信バッファが3分の2以上まで埋まるとXOFFコードを送信
し、3分の1以上まで空くとXONコードを送信します。逆に、送信時にXOFFを
受信すると送信を停止し、XONを受信すると送信を開始します。

      受信バッファサイズは1024バイト固定です。
      XONコードは0x11、XOFFコードは0x13で固定です。

  Duplex(U)：全二重、半二重設定です。通信したい相手機器との設定に合
わせてください。設定値が正常でない場合、正常に通信できない場合があり
ます。

>オプション  
  オートラップ：一定文字数が表示されると表示の段落が変わります。
  ニューライン：表示の段落が変わるたびに１行あけます。
  ローカルエコー：デフォルトでは受信データのみ表示しますが、このチェ
ックボックスにチェックすると送信(キー入力)データを表示します。
  コントロールオプション：通信エラー発生時に、エラー情報を表示します。

>フォント
  データ表示のフォントを変更します。
