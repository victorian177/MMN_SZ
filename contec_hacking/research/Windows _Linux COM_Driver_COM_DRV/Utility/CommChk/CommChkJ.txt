
                                                      　　株式会社コンテック
       　　　　　  ＜  シリアル通信テスト操作説明  ＞

●概要
　シリアル通信テストプログラムは、パソコンに搭載されているCOMポートまたは
　弊社コミュニケーションボードの動作確認を行う場合にご使用いただけます。

　※弊社シリアル通信ボードをご使用になる場合は、標準COMモードでご使用
　　ください。

  Windows 32bit OSの場合は i386フォルダにあるCommChk.exeを
  Windows 64bit OSの場合は amd64フォルダにアルCommChk.exeをそれぞれご使用ください。


●動作確認環境
　2つのCOMポートを使用してテストを行う場合は、クロスケーブルをご使用くださ
　い。
　また、ケーブルを使用しない場合、1つCOMポートのみ使用してテストを行いたい
　場合は、以下の方法により実現することが可能です。

　[RS-422/485の場合]
　　RS-422/485ボードはボードのスイッチ設定を変更することによりケーブルやコ
　　ネクタなしでテストを行うことが可能です。
　　< COM-2PD(PCI)H >
　　　CH1でテストする場合：SW3の1〜6を『on,off,off,on,on,off』に設定
　　　CH2でテストする場合：SW5の1〜6を『on,off,off,on,on,off』に設定

　　< COM-4PD(PCI)H >
　　　CH1でテストする場合：SW3の1〜6を『on,off,off,on,on,off』に設定
　　　CH2でテストする場合：SW5の1〜6を『on,off,off,on,on,off』に設定
　　　CH3でテストする場合：SW7の1〜6を『on,off,off,on,on,off』に設定
　　　CH4でテストする場合：SW9の1〜6を『on,off,off,on,on,off』に設定

　　< COM-2PD(PCI),COM-2PD(PC)H >
　　　CH1でテストする場合：SW2の1〜8を『on,off,off,on,on,off,off,off』に設定
　　　CH2でテストする場合：SW3の1〜8を『on,off,off,on,on,off,off,off』に設定

　　< COM-1D(PM) >
　　　SW1の1〜8を『on,off,off,on,on,off,off,off』に設定

　[RS-232Cの場合]
　　RS-232Cのボードの場合は、通信を折り返すコネクタを作成することにより1つ
　　のCOMポートでテストを行うことが可能です。

　　コネクタ配線図
 　 　＜9ピンの場合＞
　　　　　┌─────┐
　　　　　│　  TxD  3├─┐
　　　　　│　  RxD  2├─┘
　　　　　│　  RTS  7├─┐
　　　　　│　  CTS  8├─┘
　　　　　│　　DTR  4├─┐
　　　　　│　　DSR  6├─┘
　　　　　└─────┘

　　　＜25ピンの場合＞
　　　　　┌─────┐
　　　　　│　  TxD  2├─┐
　　　　　│　  RxD  3├─┘
　　　　　│　  RTS  4├─┐
　　　　　│　  CTS  5├─┘
　　　　　│　　DTR 20├─┐
　　　　　│　　DSR  6├─┘
　　　　　└─────┘

●操作説明

[COM設定]
　[デバイス1:]
　　通信テストを行うCOMポートを選択します。COM1〜COM255まで選択が可能です。

　[デバイス2:]
　　通信テストを行うCOMポートを選択します。COM1〜COM255まで選択が可能です。

　[環境設定]
　　ボーレート、データ長、ストップビット、パリティを選択します。
　　ここで選択された環境は、デバイス1、デバイス2に設定されます。

　　[ボーレート：]
　　　通信ボーレートを選択します。ボーレートは、以下から選択が可能です。
      使用するCOMポートにより、設定できるボーレートは異なります。
　　　300,600,1200,2400,4800,9600,19200,38400,57600,115200,230400,460800, 921600

　　[データ長：]
　　　データ長を選択します。データ長は、以下から選択が可能です。
      5,6,7,8
　　　
　　[ストップビット：]
　　　ストップビットを選択します。ストップビットは、以下から選択が可能です。
　　　1,1.5,2

　　[パリティ：]
　　　パリティを選択します。パリティは、以下から選択が可能です。
　　　偶数、奇数、なし

[送受信文字タイプ]
　[バイナリコード]
　　01h〜FFhまでのコードをテスト時に送信します。
　[アスキーコード]
　　送信文字列で設定された文字列をテスト時に送信します。

　　[送信文字列：]
　　　送受信確認を行うユーザ定義文字列を設定します。最大1024文字まで設定可能
　　　です。

[テスト回数]
　[1回のみ]
　　繰り返しタイプで指定されたテストを1回のみ実行します。

　[指定回数]
　　繰り返しタイプで指定されたテストを指定された回数実行します。

　　[回数]
　　　テストを繰り返す回数を設定します。最大2,147,483,647まで設定可能です。

　[無限]
　　繰り返しタイプで指定されたテストを回数に制限なく実行します。テストを中
　　止する場合は停止ボタンをクリックしてください。

[テスト項目]
　各テスト項目の実行結果を"OK"、"NG"で表示します。
　テストを実行しなかった場合は"--"を表示します。

　[毎回オープン/クローズを実行する]
　　オープン/クローズ処理の頻度を設定します。チェックすると文字列送信の度
　　にオープン/クローズ処理を行います。

　[COMオープン：]
　　[デバイス1：]
　　　デバイス1で選択されたCOMポートオープンの実行結果を"OK"、"NG"で表示し
　　　ます。
　　　実行しなかった場合は、"--"を表示します。

　　[デバイス2：]
　　　デバイス2で選択されたCOMポートオープンの実行結果を"OK"、"NG"で表示し
　　　ます。
　　　実行しなかった場合は、"--"を表示します。

　[デバイス1送信→デバイス2受信：]
　　チェックされるとデバイス1送信→デバイス2受信テストを実行します。
　　文字列送受信の実行結果を"OK"、"NG"で表示します。
　　実行しなかった場合は、"--"を表示します。
　　受信側で通信エラーが発生した場合は、下記の表示がなされます。
　　"NG:OE"を表示した場合、オーバーランエラーが発生しています。
　　"NG:FE"を表示した場合、フレーミングエラーが発生しています。
　　"NG:PE"を表示した場合、パリティエラーが発生しています。

　[デバイス2送信→デバイス1受信：]
　　チェックされるとデバイス2送信→デバイス1受信テストを実行します。
　　文字列送受信の実行結果を"OK"、"NG"で表示します。
　　実行しなかった場合は、"--"を表示します。
　　受信側で通信エラーが発生した場合は、下記の表示がなされます。
　　"NG:OE"を表示した場合、オーバーランエラーが発生しています。
　　"NG:FE"を表示した場合、フレーミングエラーが発生しています。
　　"NG:PE"を表示した場合、パリティエラーが発生しています。

　[COMクローズ：]
　　[デバイス1：]
　　　デバイス1で選択されたCOMポートクローズの実行結果を"OK"、"NG"で表示し
　　　ます。
　　　実行しなかった場合は、"--"を表示します。
　　[デバイス2：]
　　　デバイス2で選択されたCOMポートクローズの実行結果を"OK"、"NG"で表示し
　　　ます。
　　　実行しなかった場合は、"--"を表示します。

[送受信回数：]
　テストを実行した回数を表示します。

[結果：]
　テストの実行結果を表示します。
　エラーメッセージが表示された場合は、［テスト項目]で"NG"が表示されたテスト
　での内容になります。

[開始/停止ボタン]
　テスト開始/停止ボタンです。
　開始ボタンをクリックされると停止ボタンに切り替わります。

[ヘルプボタン]
　本ヘルプファイルを表示します。

[終了ボタン]
　本サンプルプログラムを終了します。



◆ バージョンアップ履歴　CommChk.exe
==========================================
  Ver1.22 -> Ver1.23 2014/02/12 
  ・フロー制御を"なし"に設定したときに、COM-1xx(USB)Hで通信できない不具合を修正しました。
　　この現象はVer.1.22でのみ発生します。
 
 Ver1.20 -> Ver1.22 2013/02/05 
  ・項目にフロー制御の項目を追加しました。

  Ver1.11 -> Ver1.20 2009/12/28 [COM Setup Disk 2.00]
  ・Windows 64bit Operation Systemに対応しました。( amd64\CommChk.exeのみ )

  Ver1.10 -> Ver1.11 2007/12/28 [COM Setup Disk 1.90]
　・Windows NTなどで起動させた場合, "MFC42.DLLがありません。"と
　　エラーメッセージが発生するため、これを修正。

  Ver1.07 -> Ver1.10 2006/10/31
  ・ログ排出機能追加（「CommChk.exe /D」で有効）
　・PurgeComm実行選択機能追加（「CommChk.exe /P」で無効）
　　デフォルトではPurgeCommを実行する。
　
　Ver1.05 -> Ver1.07 2005/08/19
　・PortOpen後、念のためにPurgeComm処理を追加。
　・低速ボーレート設定時、全データ送出前にタイムアウトが発生してしまい、データ
　　コンペアエラーが発生するのを回避。
　・通信中に停止ボタンを押すと、次にポートをOPENできなくなる場合があるのを修正。
　　また、タイミングによってはINVALID HANDLEエラーとなってしまうのを修正。
　・バイナリデータ送受信で、Data Bitが8Bit以外のとき(例：7bit)データコンペア
　　エラーが発生するため、データビットが変更するたびにバイナリコードを変更する
　　ように修正。

　Ver1.00 -> Ver1.05 2004/06/24
　・通信中に停止ボタンを押すと、次にポートをOPENできなくなる場合があるのを修正。
　　また、タイミングによってはINVALID HANDLEエラーとなってしまうのを修正。
　・タイムアウト設定値変更。
　・半二重設定選択機能追加。
　・通信エラー情報表示機能追加。
　・ポートOPENに失敗時、エラーを返さない場合があるのを修正。
　・高速ボーレートでの通信時に、通信が止まってしまう場合があるのを修正。

以　上
